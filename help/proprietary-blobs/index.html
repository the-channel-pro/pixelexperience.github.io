<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
    <meta name="description" content="Working with proprietary blobs - PixelExperience Wiki">
    <meta property="og:title" content="Working with proprietary blobs - PixelExperience Wiki">
    <meta property="og:description" content="Working with proprietary blobs - PixelExperience Wiki">
    <meta property="og:site_name" content="Working with proprietary blobs - PixelExperience Wiki">
    <meta property="og:image" content="https://download.pixelexperience.org/images/banner.png" />
    <meta name="keywords" content="wiki,wiki pe,pixel experience,pixel,experience,oreo,google,google pixel,android 10,android q,pie,aosp,ten,android,custom rom,rom">
    <meta name="msapplication-TileColor" content="#2D2D2D">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#2D2D2D">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">

    <title>Working with proprietary blobs - PixelExperience Wiki</title>

    <link href="/assets/css/material-kit.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Product+Sans:350,400,500,700|Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
    <script src="/assets/js/main.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js" integrity="sha256-WofcoLT8gToeaSmVRe28qpnlFxdBJH1n4K6Bk3YowvU=" crossorigin="anonymous"></script>


  </head>
  <body>

    <nav class="navbar fixed-top navbar-expand-lg bg-white mb-0 rounded-0">
  <div class="container">
    <div class="navbar-translate">
      <a class="navbar-brand font-weight-bold" href="/"><img src="/images/logo.png" alt="PixelExperience"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="navbar-toggler-icon"></span>
        <span class="navbar-toggler-icon"></span>
        <span class="navbar-toggler-icon"></span>
      </button>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a href="/devices/" class="nav-link">Devices</a>
          </li>
          <li class="nav-item">
            <a href="/help/contributing/" class="nav-link">Contribute</a>
          </li>
          <li class="nav-item">
            <a href="/help/developer-information/" class="nav-link">Maintainers</a>
          </li>
          <li class="nav-item">
            <a href="https://download.pixelexperience.org" class="nav-link">
              <i class="material-icons">open_in_new</i>
              Website
            </a>
          </li>
        </ul>

        <form class="form-inline ml-auto" autocomplete="off">
          <div class="form-group no-border">
            <i class="material-icons">search</i>
            <input id="search-input" type="text" class="form-control" placeholder="Search">
          </div>

          <ul id="results-container"></ul>


          <script src="/assets/js/jekyll-search.js" type="text/javascript"></script>
          <script type="text/javascript">
              SimpleJekyllSearch.init({
                  searchInput: document.getElementById('search-input'),
                  resultsContainer: document.getElementById('results-container'),
                  dataSource: '/search.json',
                  searchResultTemplate: '<li><a href="{url}" title="Working with proprietary blobs">{title}</a></li>',
                  noResultsText: '<li><a href="#">No results found.</a></li>',
                  limit: 10,
                  fuzzy: true,
              })
          </script>
        </form>

      </div>
    </div>
  </nav>


    <div class="main-content">

      <div class="container page">

  <h1>Working with proprietary blobs</h1>

  
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>
<h2 id="working-with-proprietary-blobs">Working with proprietary blobs</h2>

<p>All devices should have a list of proprietary blobs in their device tree called <code class="highlighter-rouge">proprietary-files.txt</code>.  This list is used to create the vendor repository for building the device by extracting blobs from a device running the latest copy of PixelExperience and/or from a system dump.  Generally devices need only one list of blobs although you may encounter devices that have both <code class="highlighter-rouge">proprietary-files.txt</code> and <code class="highlighter-rouge">proprietary-files-qc.txt</code> (or more).  There is no need to split the files and the reason for the split is largely historical at this point.</p>

<p>To start, copy the templates <code class="highlighter-rouge">extract-files.sh</code> and <code class="highlighter-rouge">setup-makefiles.sh</code> from <code class="highlighter-rouge">vendor/aosp/build/templates</code> to your device tree and edit them to fill in the three required fields (device, vendor and copyright year).</p>

<p>The contents of <code class="highlighter-rouge">proprietary-files.txt</code> is a list of blobs with optional comments (lines beginning with <code class="highlighter-rouge">#</code>).  Each blob line is of the form:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[-]source[:destination][|sha1sum]
</code></pre></div></div>

<p>Each filename is relative to the system partition.  The entry <code class="highlighter-rouge">vendor/lib/libblob.so</code> will be extracted from and later installed to <code class="highlighter-rouge">/system/vendor/lib/libblob.so</code>.  Example of all the variations that you write are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libbasic.so
-libneeded-to-build.so
libsource.so:libdestination.so
-libneeded-source.so:libneeded-destination.so
libstock.so|sha1sum
-libstock-needed.so|sha1sum
-libstock-source.so:libstock-destination.so|sha1sum
</code></pre></div></div>

<p>If the entry begins with a dash (<code class="highlighter-rouge">-</code>) then the vendor repository will declare a module that provides the blob.  This is needed if the blob is used to build another component in Android.  If the dash does not exist then the blob will simply be copied during the build.</p>

<p>If the entry has a colon (<code class="highlighter-rouge">:</code>) with <code class="highlighter-rouge">source</code> and <code class="highlighter-rouge">destination</code> names, the extractor will check to see if the destination file exists.  If the destination file exists it will be extracted.  If not, the source filename will be extracted but saved to the destination name.  This allows you to pull either from a stock (unrenamed) dump or a PixelExperience dump/device while renaming it.</p>

<p>The <code class="highlighter-rouge">sha1sum</code>, is the checksum of the version of the blob that we want to “pin”.  If the copy of that blob in the existing vendor tree does not match the <code class="highlighter-rouge">sha1sum</code> then it is ignored and extraction proceeds normally.  If it does match then it will be kept regardless of the contents of the device/dump you are pulling from.</p>

<div class="alert alert-success" role="alert"><div class="alert-icon"><i class="material-icons">check</i></div><div class="alert-text"><b>Tip:</b> 
The sha1sum is very useful if you are going to update your blobs from a stock image when you have kanged blobs from other devices.  If you list the sha1sums of any kanged or hexedited (aka non-stock) blobs, then you can always update the stock blobs without fear of losing your customizations.
</div></div>

<div class="alert alert-success" role="alert"><div class="alert-icon"><i class="material-icons">check</i></div><div class="alert-text"><b>Tip:</b> 
If you hexedit a blob or pull kang it from another device, you will need to update the <code class="highlighter-rouge">proprietary-files.txt</code> list to update the <code class="highlighter-rouge">sha1sum</code>.  Please take the time to document the source of the kang or steps to reproduce the hexediting.
</div></div>

<p>If you extract an app (<code class="highlighter-rouge">*.apk</code>) or jar file from an odexed system dump (aka, has boot.oats) and the app/jar does not already contain a classes.dex, it will be automatically de-odexed when extracted.</p>


</div>


    </div>

    <footer class="footer mt-5 px-2 py-4 ">
  <div class="container">
    <div class="row">
      <div class="col-md text-center text-md-left">
        <p class="text-muted my-0"><b>&copy; 2018 - 2020 The PixelExperience Project</b></p>
      </div>
      <div class="col-md">
        <p class="text-center text-md-right text-muted">Licensed under <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a>.<br />
         Site last generated: Aug 18, 2020</p>
      </div>
    </div>
  </div>
</footer>


    <script>anchors.add().remove('h1');</script>

  </body>
</html>
